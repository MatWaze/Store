@model ProfileViewModel

<style>
    /* Styling for profile nav */
    #profileNav {
        margin-left: -15px; /* Move sidebar slightly to the left */
    }

    #profileNav .nav-link {
        background-color: transparent;
        color: #000;
        padding: 10px;
        display: block;
        text-decoration: none;
        transition: all 0.2s ease-in-out;
        text-align: left;
        position: relative;
        width: 100%;
        box-sizing: border-box;
    }

    #profileNav .nav-link:hover::before {
        border-color: #ccc;
    }

    #profileNav .nav-link.active {
        background-color: #e6f0ff;
        border-radius: 5px;
        width: 100%;
    }

    /* Hide all sections initially */
    .section-content {
        display: none;
        padding-left: 15px; /* Align text with sidebar */
    }

    /* Show the active section */
    .section-content.active {
        display: block;
    }

    /* Style for the main section headings */
    .section-content h3 {
        margin-top: 0; /* Remove margin at the top of headings */
    }
</style>

@using Syncfusion.EJ2

<section class="padding-large product-store">
    <div class="container mt-2">
        <h3>Account Profile</h3>
        <div class="row mt-4">
            <!-- Profile Navbar (Sidebar) -->
            <nav id="profileNav" class="col-md-2 d-md-block sidebar">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="#basicInfoSection" onclick="showSection('basicInfoSection')">Basic Info</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#addressSection" onclick="showSection('addressSection')">Address</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#ordersSection" onclick="showSection('ordersSection')">Orders</a>
                    </li>
                </ul>
            </nav>

            <!-- Profile Sections -->
            <div class="col-md-9">
                <div id="basicInfoSection" class="section-content active py-3">
                    <h3>Basic Info</h3>
                    <form id="userForm" asp-controller="Profile" asp-action="SaveBasicInfo" method="post">
                        <div class="form-group">
                            <label>User Name</label>
                            <input disabled class="form-control" id="@Model.User.UserName" asp-for="@Model.User.UserName" />
                        </div>
                        <div class="form-group">
                            <label>Full Name</label>
                            <input disabled class="form-control" id="@Model.User.FullName" asp-for="@Model.User.FullName" />
                        </div>
                        <div class="form-group">
                            <label>Email</label>
                            <input disabled type="email" class="form-control" id="@Model.User.Email" asp-for="@Model.User.Email" />
                        </div>
                        <button type="button" id="changeButton" class="btn btn-primary mt-2">Change</button>
                        <button disabled type="submit" id="saveButton" class="btn btn-primary mt-2">Save</button>
                    </form>
                </div>

                <div id="addressSection" class="section-content py-3">
                    <h3>Shipping Address</h3>
                    <form asp-controller="Profile" asp-action="SaveAddress" method="post">
                        <div class="form-group">
                            <label>Country</label>
                            <input class="form-control" id="@Model.User.Country?" 
                                asp-for="@Model.User.Country" />
                        </div>
                        <div class="form-group">
                            <label>Region</label>
                            <input class="form-control" id="@Model.User.Region?"
                                asp-for="@Model.User.Region" />
                        </div>
                        <div class="form-group">
                            <label>City</label>
                            <input class="form-control" id="@Model.User.City?"
                                asp-for="@Model.User.City" />
                        </div>
                       <div class="form-group">
                            <label>Street Line</label>
                            <input class="form-control" id="@Model.User.Street?"
                                asp-for="@Model.User.Street" />
                        </div>
                        <div class="form-group">
                            <label>Postal Code</label>
                            <input class="form-control" id="@Model.User.PostalCode?"
                                asp-for="@Model.User.PostalCode" />
                        </div>
                        <button type="submit" id="saveButton" class="btn btn-primary mt-2">Save</button>
                    </form>
                </div>

                <div id="ordersSection" class="section-content py-3">
                    <h3>Orders</h3>
                    <div class="container padding-small">
                        @if (Model.Orders.Count() > 0)
                        {
                            <div class="list-group">
                                @foreach (Order o in Model.Orders)
                                {
                                    <div class="list-group-item">
                                        <h5 class="mb-1">Order №@o.OrderID</h5>
                                        <h6 class="mt-3">Products:</h6>
                                        <ul class="list-group">
                                            @foreach (CartLine line in o.Lines)
                                            {
                                                <li class="list-group-item">
                                                    @line.Product.Name - Quantity: @line.Quantity
                                                </li>
                                            }
                                        </ul>
                                    </div>
                                }
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-warning text-center" role="alert">
                                No Orders
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
   
    document.getElementById('changeButton').addEventListener('click', function() {
        const saveButton = document.querySelector("#saveButton");
        saveButton.disabled = false;
        const inputs = document.querySelectorAll('#userForm input');
        inputs.forEach(input => {
            input.disabled = false; // Remove the 'disabled' attribute
        });
    });
    // Function to display the correct section and hide others
    function showSection(sectionId) {
        // Get all sections
        const sections = document.querySelectorAll('.section-content');

        // Hide all sections
        sections.forEach(section => {
            section.classList.remove('active');
        });

        // Show the selected section
        const selectedSection = document.getElementById(sectionId);
        if (selectedSection) {
            selectedSection.classList.add('active');
        }

        // Remove 'active' class from all nav links
        const navLinks = document.querySelectorAll('#profileNav .nav-link');
        navLinks.forEach(link => {
            link.classList.remove('active');
        });

        // Add 'active' class to the clicked nav link
        const activeLink = document.querySelector(`#profileNav .nav-link[href='#${sectionId}']`);
        if (activeLink) {
            activeLink.classList.add('active');
        }
    }
</script>
